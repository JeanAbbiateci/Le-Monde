
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<!-- <link rel="stylesheet" type="text/css" href="./lemonde.css">
	<link rel="stylesheet" type="text/css" href="http://s1.lemde.fr/medias/web/css/fonts.css"> -->
	<script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.js"></script>
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
	<script src="data.json" type="text/javascript"></script>
	<!-- <script src="http://code.highcharts.com/highcharts.js"></script> -->

	<!-- <script type="text/javascript" charset="utf-8" src="class.Gselper.js"></script> -->
	<script type="text/javascript">
	
	var latlng = new google.maps.LatLng(48.86,2.34);
	
	

	function createMarker() {
		for(var i=0;i<580;i++) {			
			longit = cumulards[i]['longitude'];
			latit = cumulards[i]['latitude'];
			addMarker(longit,latit);
		}
	};


	function addMarker(lng,lat) {
		var marker = new google.maps.Marker({
			position: new google.maps.LatLng(lat,lng),
			map: map
		});


				
		marker.setIcon(new google.maps.MarkerImage('marker.png',new google.maps.Size(25,25),new google.maps.Point(0,0)));

		google.maps.event.addListener(marker,'click',function() {
			$("#notices").html(text);
		});
		
		return marker;
	}

	function addPolygon(map,number,table) {
		var html = "",path = [];
		var element = table.get(number);
		
		var pathTable = $.parseJSON(element.json);

		$.each(pathTable, function(key, val) {
			path.push(new google.maps.LatLng(pathTable[key][1],pathTable[key][0]));
		});

		color = element.couleurhexa
		
		var polygon = new google.maps.Polygon({
			paths: path,
			strokeColor: "#333",
			strokeOpacity: 0.5,
			strokeWeight: 0.5,
			fillColor: color,
			fillOpacity: 0.5,
			map: map
		});
		
		google.maps.event.addListener(polygon,'mouseover',function() {
			polygon.setOptions({paths:path,fillOpacity:0.2})
		});
				
		if(element.ardt == 1) html = "<p><span class=\"tt26_capital\">" + element.ardt + "<sup>er</sup> arrondissement</span><br />";
		else html = "<p ><span class=\"tt26_capital\">" + element.ardt + "<sup>e</sup> arrondissement</span><br />";

		html += element.nbconseillers + " conseiller"
		if(element.nbconseillers > 1) html += "s"
		html += " de Paris à élire dans cet arrondissement."


		//- NOTULE -//
		
		html += "<br /><p>"+element.notule+"</p>";

	
		//- CURSEUR 2008 -//
	
		html += "<p style='margin-top:10px'>Lors des élections municipales en <strong>2008</strong>, <strong>la "+element.vainqueur2008+"</strong> l'emporte"
		if(element.tour2008 == 1) html += " au premier tour "
		else html += " au second tour "
		html += "dans l'arrondissement, avec <strong>" + Math.floor(element.score2008*10000)/100+"&nbsp;%</strong>"
	
		html += "<span style='width:100%;float:left;min-height:15px;margin-top:5px;background:"
		if(element.vainqueur2008 == "gauche") html += "#2956aa'>"
		else html += "#d60065'>" 
		//- Ve ARRONDISSEMENT -//
		html += "<span style='margin:0;background:"
		if(element.vainqueur2008 == "gauche") html += "#d60065"
		else html += "#2956aa" 
		html += ";float:left;width:"+Math.floor(element.score2008*10000)/100+"%'>&nbsp;</span>"
		
		if(element.ardt == 5) {
			html += "<span style='margin:0;padding:0;min-height:15px;float:left;background:#f76a00;width:10.9%'>&nbsp;</span>"		
		}

		
		html+= "</span></p><br />"
	
		html += "<p>Au second tour de l'élection présidentielle en <strong>2012</strong>, <strong>la "+element.vainqueur2012+"</strong> arrive en tête dans l'arrondissement avec <strong>" + Math.floor(element.score2012*10000)/100+"&nbsp;%</strong> des voix."


		//- CURSEUR 2012 -//
		
		html += "<span style='width:100%;float:left;min-height:15px;margin-top:5px;background:"
		if(element.vainqueur2012 == "gauche") html += "#2956aa"
		else html += "#d60065" 
		html += "'><span style='margin:0;float:left;background:"
		if(element.vainqueur2012 == "gauche") html += "#d60065"
		else html += "#2956aa" 
		html += ";width:"+Math.floor(element.score2012*10000)/100+"%'>&nbsp;</span></span></p>"
		
		//- TETE DE LISTE -//

		html += "<br /><strong class=\"tt17_capital\">TÊTES DE LISTES ANNONCEÉS</strong>"
		
		
		//-- TETE DE LISTE DU PARTI DE GAUCHE --//
		html += "Tête de liste PG : "
		if(element.tetepg == "") html += "<em>pas encore annoncée</em>"
		else html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.tetepg+"</strong>"

		if(element.candidatpg == "oui") html += " (candidate à la mairie de Paris)"

		html += "<br />"

		//-- TETE DE LISTE DES VERTS --//
		html += "Tête de liste EELV : "
		html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.teteeelv+"</strong>"
		
		if(element.sortanteelv == "oui" && element.sexeeelv == "femme") html += " (maire sortante)"
		if(element.sortanteelv == "oui" && element.sexeeelv == "homme") html += " (maire sortant)"
		if(element.candidateelv == "oui") html += " (candidat à la mairie de Paris)"
		
		html += "<br />"

		//-- TETE DE LISTE DE GAUCHE --//
		html += "Tête de liste PS et alliés : "
		html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.teteps+"</strong>"
		
		if(element.sortantps == "oui" && element.sexeps == "femme") html += " (maire sortante)"
		if(element.sortantps == "oui" && element.sexeps == "homme") html += " (maire sortant)"
		if(element.candidatps == "oui") html += " (candidate à la mairie de Paris)"
		
		html += "<br />"
		
		//-- TETE DE LISTE DE DROITE --//
		html += "Tête de liste UMP : "
		if(element.tetedroite == "") html += "<em>pas encore annoncée</em>"
		else html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.tetedroite+"</strong>"

		if(element.sortantdroite == "oui" && element.sexedroite == "homme") html += " (maire sortant)"
		if(element.sortantdroite == "oui" && element.sexedroite == "femme") html += " (maire sortante)"
		if(element.candidatdroite == "oui") html += " (candidate à la mairie de Paris)"

		html += "<br />"
		
		if(element.dissidence != "")  {

		html += "Dissidence possible à droite : "
		html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.dissidence+"</strong><br />"

		}
		
		//-- TETE DE LISTE D'EXTREME-DROITE --//
		html += "Tête de liste FN : "
		if(element.tetefn == "") html += "<em>pas encore annoncée</em>"
		else html +=  "<strong class=\"tt17_capital\" style=\"display:inline\">"+element.tetefn+"</strong>"

		if(element.candidatfn == "oui") html += " (candidat à la mairie de Paris)"
		
		
		
		//-- CONSTRUCTION DE LA CARTE --//
		google.maps.event.addListener(polygon,'click',function() {
			$("#notices").html(html);	
		});
		
		google.maps.event.addListener(polygon,'mouseout',function() {
			polygon.setOptions({fillOpacity:0.5})
		});
		
		return polygon;

	}
	
	function createPolygon(map,table) {
		for(var i=0;i<20;i++) {
			addPolygon(map,i,table);
		}
	}
	
	$(document).ready(function () {
		var mapOptions = {
			zoom: 5,
			minZoom: 4,
			center: latlng,
			mapTypeControlOptions: false,
			mapTypeId: google.maps.MapTypeId.ROADMAP,
			mapTypeControl: false,
			draggable: true,
			panControl: false,
			scrollwheel: true,
			zoomControl: false,
			streetViewControl: false,
			disableDoubleClickZoom: false,
			styles: [
			  {
				"elementType": "geometry",
				"stylers": [
				  { "saturation": -100 }
				]
			  },{
				"elementType": "labels",
				"stylers": [
				  { "visibility": "off" }
				]
			  },{
				"featureType": "water",
				"stylers": [
				  { "saturation": 75 },
				  { "hue": "#004cff" }
				]
			  },{
				"featureType": "road",
				"elementType": "geometry",
				"stylers": [
				  { "lightness": 50 }
				]
			  },{
			  }
			]
		};
		var map = new google.maps.Map(document.getElementById("map"),mapOptions);


		for(var i=0;i<cumulards.length;i++) {			
			
			
				/*var marker = new google.maps.Marker({
	      		position: new google.maps.LatLng(latit,longit),
			    map: map,
			    title: 'Hello World!'
				});*/

			addMarker(cumulards,i);
		}

		var infowindow;

		function addMarker(cumulards,i) {
			longit = cumulards[i]['longitude'];
			latit = cumulards[i]['latitude'];
			ville = cumulards[i]['ville'];
			console.log(ville)
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng(latit,longit),
				map: map
			});
			
			if (infowindow) infowindow.close();
			infowindow = new google.maps.InfoWindow({content: cumulards[i]['ville']});

			  google.maps.event.addListener(marker, 'click', function() {
			  	/* infowindow.close();*/
			    infowindow.open(map,marker);
			  });
			
      		/*infowindow.open(map, marker);*/

			/*var infowindow = new google.maps.InfoWindow({
		      content: ville
		  });*/

			marker.setIcon(new google.maps.MarkerImage('marker.png',new google.maps.Size(20,20),new google.maps.Point(0,0)));

			



			google.maps.event.addListener(marker,'click',function() {
				$("#notices").html(ville);
			});

			return marker;
		}

		/*var marker = new google.maps.Marker({
      		position: new google.maps.LatLng(48.86,2.34),
		    map: map,
		    title: 'Hello World!'
		});*/


/*		var table = new Gselper({
		    key: "0AiWUhxLpQgUXdHZvRWFRVUpsdzdHUlc4OWJMZHh4QUE",
		    worksheet: "od6",
		    onComplete: function() {
				createPolygon(map,table);
			}
		});*/
	});
	</script>
	<style type="text/css" media="screen">
		* {margin: 0;padding:0;}
		body {width:1000px;height:520px;font:normal 130% arial,sans-serif}
		#map {width:1000px;height:550px;float:right;}
		#column {width:430px;float:left;padding-left:5px;padding-top:0;}
		#legend {width:430px;position:absolute;bottom:0;background:white;padding:0;margin:0}
		#notices p {width:430px;margin-top:5px;}
		#chapo {margin-bottom:5px;}
		.space {height:5px}
	</style>
	<title>Municipales à Paris</title>
</head>
<body>

	<div id="map"></div>
	<div id="notices"></div>
</body>
</html>